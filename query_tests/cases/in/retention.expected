-- Test Setup: ThreeChunksWithRetention
-- SQL: SELECT * FROM cpu order by host, load, time;
+------+------+----------------------+
| host | load | time                 |
+------+------+----------------------+
| a    | 1    | 1970-01-01T00:00:00Z |
| b    | 2    | 1970-01-01T00:00:00Z |
| bb   | 21   | 1970-01-01T00:00:00Z |
+------+------+----------------------+
-- SQL: EXPLAIN SELECT * FROM cpu order by host, load, time;
-- Results After Normalizing UUIDs
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: cpu.host ASC NULLS LAST, cpu.load ASC NULLS LAST, cpu.time ASC NULLS LAST                                                                                                                        |
|               |   Projection: cpu.host, cpu.load, cpu.time                                                                                                                                                             |
|               |     TableScan: cpu projection=[host, load, time]                                                                                                                                                       |
| physical_plan | SortExec: [host@0 ASC NULLS LAST,load@1 ASC NULLS LAST,time@2 ASC NULLS LAST]                                                                                                                          |
|               |   CoalescePartitionsExec                                                                                                                                                                               |
|               |     ProjectionExec: expr=[host@0 as host, load@1 as load, time@2 as time]                                                                                                                              |
|               |       RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                                 |
|               |         DeduplicateExec: [host@0 ASC,time@2 ASC]                                                                                                                                                       |
|               |           SortPreservingMergeExec: [host@0 ASC,time@2 ASC]                                                                                                                                             |
|               |             SortExec: [host@0 ASC,time@2 ASC]                                                                                                                                                          |
|               |               UnionExec                                                                                                                                                                                |
|               |                 CoalesceBatchesExec: target_batch_size=4096                                                                                                                                            |
|               |                   FilterExec: time@2 < -9223372036854775808 OR time@2 > -3600000000000                                                                                                                 |
|               |                     RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                   |
|               |                       ParquetExec: limit=None, partitions={1 group: [[1/1/1/1/00000000-0000-0000-0000-000000000000.parquet]]}, output_ordering=[host@0 ASC, time@2 ASC], projection=[host, load, time] |
|               |                 CoalesceBatchesExec: target_batch_size=4096                                                                                                                                            |
|               |                   FilterExec: time@2 < -9223372036854775808 OR time@2 > -3600000000000                                                                                                                 |
|               |                     RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                   |
|               |                       ParquetExec: limit=None, partitions={1 group: [[1/1/1/1/00000000-0000-0000-0000-000000000001.parquet]]}, output_ordering=[host@0 ASC, time@2 ASC], projection=[host, load, time] |
|               |                                                                                                                                                                                                        |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
-- SQL: SELECT * FROM cpu WHERE host != 'b' ORDER BY host,time;
+------+------+----------------------+
| host | load | time                 |
+------+------+----------------------+
| a    | 1    | 1970-01-01T00:00:00Z |
| bb   | 21   | 1970-01-01T00:00:00Z |
+------+------+----------------------+
-- SQL: EXPLAIN SELECT * FROM cpu WHERE host != 'b' ORDER BY host,time;
-- Results After Normalizing UUIDs
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                             |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: cpu.host ASC NULLS LAST, cpu.time ASC NULLS LAST                                                                                                                                                                                                                                                           |
|               |   Projection: cpu.host, cpu.load, cpu.time                                                                                                                                                                                                                                                                       |
|               |     Filter: cpu.host != Dictionary(Int32, Utf8("b"))                                                                                                                                                                                                                                                             |
|               |       TableScan: cpu projection=[host, load, time], partial_filters=[cpu.host != Dictionary(Int32, Utf8("b"))]                                                                                                                                                                                                   |
| physical_plan | SortExec: [host@0 ASC NULLS LAST,time@2 ASC NULLS LAST]                                                                                                                                                                                                                                                          |
|               |   CoalescePartitionsExec                                                                                                                                                                                                                                                                                         |
|               |     ProjectionExec: expr=[host@0 as host, load@1 as load, time@2 as time]                                                                                                                                                                                                                                        |
|               |       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                |
|               |         FilterExec: host@0 != b                                                                                                                                                                                                                                                                                  |
|               |           RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                                                                                                                                       |
|               |             DeduplicateExec: [host@0 ASC,time@2 ASC]                                                                                                                                                                                                                                                             |
|               |               SortPreservingMergeExec: [host@0 ASC,time@2 ASC]                                                                                                                                                                                                                                                   |
|               |                 SortExec: [host@0 ASC,time@2 ASC]                                                                                                                                                                                                                                                                |
|               |                   UnionExec                                                                                                                                                                                                                                                                                      |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                  |
|               |                       FilterExec: time@2 < -9223372036854775808 OR time@2 > -3600000000000                                                                                                                                                                                                                       |
|               |                         RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                                                                                                                         |
|               |                           ParquetExec: limit=None, partitions={1 group: [[1/1/1/1/00000000-0000-0000-0000-000000000000.parquet]]}, predicate=host != Dictionary(Int32, Utf8("b")), pruning_predicate=host_min@0 != b OR b != host_max@1, output_ordering=[host@0 ASC, time@2 ASC], projection=[host, load, time] |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                  |
|               |                       FilterExec: time@2 < -9223372036854775808 OR time@2 > -3600000000000                                                                                                                                                                                                                       |
|               |                         RepartitionExec: partitioning=RoundRobinBatch(4)                                                                                                                                                                                                                                         |
|               |                           ParquetExec: limit=None, partitions={1 group: [[1/1/1/1/00000000-0000-0000-0000-000000000001.parquet]]}, predicate=host != Dictionary(Int32, Utf8("b")), pruning_predicate=host_min@0 != b OR b != host_max@1, output_ordering=[host@0 ASC, time@2 ASC], projection=[host, load, time] |
|               |                                                                                                                                                                                                                                                                                                                  |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
